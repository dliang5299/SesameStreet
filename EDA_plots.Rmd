---
title: "Exploratory Data Analysis"
output: html_notebook
---

```{r}
# libraries
library(tidyverse)
library(gridExtra)
library(corrplot)

# load data
ss <- readRDS("Data/ss.RDS") %>%
  mutate(viewcat = as.factor(viewcat))

# ggpplot options
theme_set(theme_bw())
```

```{r}
ss1 <-
  ss %>%
  na.omit #filter(percnumb < 1000)

# viewcat boxplots
v1 <- ggplot(ss1, aes(viewcat, percnumb)) +
  geom_boxplot() +
  ylim(-100, 600) +
  xlab("Viewing Category") +
  ylab("Percent Change in Number Score")
v2 <- ggplot(ss1, aes(viewcat, perclet)) +
  geom_boxplot() +
  ylim(-100, 600)+
  xlab("Viewing Category") +
  ylab("Percent Change in Letter Score")
v3 <- ggplot(ss1, aes(viewcat, percbody)) +
  geom_boxplot() +
  ylim(-100, 600)+
  xlab("Viewing Category") +
  ylab("Percent Change in Body Score")

png("viewcat_boxplot.png", width = 1280, height = 720)
gridExtra::grid.arrange(v1, v2, v3, nrow = 1)
dev.off()
```

```{r}
# correlation plots
ss_modified <- ss %>%
  select(percnumb, perclet, percbody, age, peabody)
ss_modified <- cor(ss_modified)
corrplot(ss_modified, method = "number")
```

---

# Percent Change Boxplots

```{r}

# Convert the data from wide to long so we can put it one plot
ss %>%
  select(id, percnumb, perclet, percbody) %>%
  pivot_longer(-id) %>%
  filter(value < 1000) %>%
  ggplot(aes(x = name, y = value)) +
  geom_boxplot() +
  labs(y = "Percent Change", x = "",
       title = "Child Percent Change in Pre-Post Scores", 
       subtitle = "Outlier for percnumb (1200%) removed for clarity")
```





